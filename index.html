<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Juego Musical</title>
</head>
<body>
    <h1>Bienvenido a mi Juego Musical</h1>
    
    <!-- Pantalla de login -->
    <div id="login-screen">
        <h2>Iniciar sesión</h2>
        <form id="login-form">
            <input type="email" id="email" placeholder="Correo" required>
            <input type="password" id="password" placeholder="Contraseña" required>
            <button type="submit">Iniciar sesión</button>
        </form>
        <p>No tienes cuenta? <a href="#" id="show-register">Regístrate</a></p>
    </div>

    <!-- Pantalla de registro -->
    <div id="register-screen" style="display: none;">
        <h2>Registrarse</h2>
        <form id="register-form">
            <input type="email" id="reg-email" placeholder="Correo" required>
            <input type="password" id="reg-password" placeholder="Contraseña" required>
            <button type="submit">Registrarse</button>
        </form>
        <p>Ya tienes cuenta? <a href="#" id="show-login">Inicia sesión</a></p>
    </div>

    <!-- Pantalla de activación -->
    <div id="activation-screen" style="display: none;">
        <h2>Activación</h2>
        <input type="text" id="activation-code" placeholder="Código de activación" required>
        <button onclick="validateCode()">Activar</button>
    </div>

    <!-- Pantalla del juego -->
    <div id="game-screen" style="display: none;">
        <h2>Juego en curso</h2>
        <button onclick="logout()">Cerrar sesión</button>
        <div>
            <!-- Tu juego va aquí -->
        </div>
    </div>

    <script type="module">
        // Importar las funciones necesarias de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";

        // Tu configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDJw_68IJb5zPvF4UHwgPXy-5SM4ZBAVbk",
            authDomain: "rythmic-26611.firebaseapp.com",
            projectId: "rythmic-26611",
            storageBucket: "rythmic-26611.firebasestorage.app",
            messagingSenderId: "131685337689",
            appId: "1:131685337689:web:d23cc4c6d7a980872ebf48"
        };

        // Inicializa Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Manejar el formulario de inicio de sesión
        const loginForm = document.getElementById('login-form');
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    showActivationScreen();
                })
                .catch((error) => {
                    alert('Error: ' + error.message);
                });
        });

        // Manejar el formulario de registro
        const registerForm = document.getElementById('register-form');
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    alert('Cuenta creada exitosamente');
                    showLoginScreen();
                })
                .catch((error) => {
                    alert('Error: ' + error.message);
                });
        });

        // Mostrar la pantalla de registro
        document.getElementById('show-register').addEventListener('click', () => {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('register-screen').style.display = 'block';
        });

        // Mostrar la pantalla de inicio de sesión
        document.getElementById('show-login').addEventListener('click', () => {
            document.getElementById('register-screen').style.display = 'none';
            document.getElementById('login-screen').style.display = 'block';
        });

        // Mostrar pantalla de activación
        function showActivationScreen() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('activation-screen').style.display = 'block';
        }

        // Validar el código de activación
        function validateCode() {
            const code = document.getElementById('activation-code').value;
            if (code === "ACTIVACION123") {  // Reemplaza por tu código real
                showGameScreen();
            } else {
                alert("Código incorrecto");
            }
        }

        // Mostrar pantalla del juego
        function showGameScreen() {
            document.getElementById('activation-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
        }

        // Cerrar sesión
        function logout() {
            signOut(auth).then(() => {
                document.getElementById('game-screen').style.display = 'none';
                document.getElementById('login-screen').style.display = 'block';
            }).catch((error) => {
                alert('Error al cerrar sesión: ' + error.message);
            });
        }
    </script>
</body>
</html>
